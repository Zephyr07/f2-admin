<div class="row border-bottom bd-lightGray m-3" style="margin-top:52px !important;">
  <div class="cell-md-4 d-flex flex-align-center">
    <h3 class="dashboard-section-title  text-center text-left-md w-100">Utilisateurs</h3>
  </div>

  <div class="cell-md-8 d-flex flex-justify-center flex-justify-end-md flex-align-center">
    <ul class="breadcrumbs bg-transparent">
      <li class="page-item"><a (click)="getUsers()" class="page-link">Actualiser <span class="icon"><span class="mif-refresh"></span></span></a></li>
    </ul>
  </div>
</div>

<div class="m-3">
  <div class="row">
    <div class="cell-3">
      <input type="text" [(ngModel)]="search" [ngModelOptions]="{standalone: true}" placeholder="Recherche">
    </div>
  </div>

  <div class="row mt-2">
    <table class="table cell-border compact table-border"
    >
      <thead>
      <tr>
        <th data-sortable="true" data-sort-dir="asc" data-name="facture">#</th>
        <th data-sortable="true">Identifiant</th>
        <th data-sortable="true" data-name="client">Nom</th>
        <th data-sortable="true" data-name="client">RÃ´les</th>
        <th data-sortable="true" data-name="client">Statut</th>
        <th data-sortable="true">Statut mot de passe</th>
        <th *ngxPermissionsOnly="['reset.password']">Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let i of users | filter:{ id: search, username: search, name: search} : false" [ngClass]="{'dark':i.check==true}">
        <td>{{i.id}}</td>
        <td>{{i.username}}</td>
        <td>{{i.name}}</td>
        <td>
          <span *ngFor="let r of i.roles">{{r.name}},</span>
        </td>
        <td>{{i.status}}</td>
        <td>{{i.has_reset_password}} {{i.settings}}</td>
        <td *ngxPermissionsOnly="['reset.password']">
          <button class="button mini" (click)="editUser(i)"><span class="mif-pencil"></span></button>
        </td>
      </tr>

      </tbody>
    </table>
  </div>

</div>

<div class="dialog" data-role="dialog" id="userDialog1">
  <div class="dialog-title"></div>
  <div class="dialog-content" >
    <div class="form-group">
      <div>{{user.username}}</div>
      <div>{{user.name}}</div>
      <div>{{user.status}}</div>
    </div>
    <div class="form-group">
      <label>RÃ´les</label>
      <select [(ngModel)]="user_roles" [ngModelOptions]="{standalone: true}"multiple style="height: 90px">
        <option *ngFor="let r of roles" value="{{r.id}}">{{r.name}}</option>
      </select>
    </div>{{user.has_reset_password}}
    <m4-switch [(ngModel)]="user.has_reset_password" caption="Activer le compte" caption-position="left"></m4-switch>
    <div class="form-group">
      <input type="checkbox" *ngIf="!user.has_reset_password" [(ngModel)]="user.has_reset_password" data-role="checkbox" data-caption="Reinitialiser le mot de passe">
      <input type="checkbox" *ngIf="user.has_reset_password" [(ngModel)]="user.has_reset_password" data-role="checkbox" data-caption="Reinitialiser le mot de passe">
    </div>
    <div class="form-group">
      <input type="checkbox" *ngIf="user.status=='enable'" [(ngModel)]="user.status" (click)="user.status='disabled'" data-caption="Desactiver le compte">
    </div>
    <div class="form-group">{{user.status}}
      <input type="checkbox" *ngIf="user.status!='enable'" [(ngModel)]="user.status" (click)="user.status='enable'" data-caption="Activer le compte">
    </div>
  </div>

  <div class="dialog-actions text-right">
    <button class="button js-dialog-close bg-or fg-white" (click)="updateUser()">Enregistrer</button>
    <button class="button primary js-dialog-close bg-noir">Fermer</button>
  </div>
</div>
